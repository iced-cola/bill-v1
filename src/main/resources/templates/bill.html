<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="content-type" charset="UTF-8">
    <title>我的账单</title>
    <link rel="stylesheet" type="text/css"
          href="../lib/bootstrap-3.3.7/dist/css/bootstrap.min.css">
</head>
<body>
<nav class="navbar navbar-inverse" role="navigation">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#example-navbar-collapse">
                <span class="sr-only">切换导航</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">
                <!-- <img src="<%=path %>/images/a.jpg" height="100%" /> -->
                <span>理性消费 健康生活</span>
            </a>
        </div>
        <div class="collapse navbar-collapse" id="example-navbar-collapse">
            <ul class="nav navbar-nav">
                <li class="active">
                    <a class="icon-bar" th:href="@{/bill/list}">账单一览</a>
                </li>
                <li><a th:href="@{/bill/type}">账单分类</a>
                </li>
                <li><a th:href="@{/sys/info}">系统信息</a>
                </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="#" th:href="@{/logout}">安全退出</a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<div class="container-fluid">
    <div class="row">
        <div class="col-sm-2">
            <a th:href="@{/bill/list}" class="list-group-item active">
                <span class="glyphicon glyphicon-list"></span>&nbsp;&nbsp;账单一览
            </a>
            <a th:href="@{/bill/type}" class="list-group-item">
                    <span class="glyphicon glyphicon-tags" aria-hidden="true">
                    </span>&nbsp;&nbsp;账单分类</a>
            <a th:href="@{/sys/info}" class="list-group-item">
                    <span class="glyphicon glyphicon-user" aria-hidden="true">
                    </span>&nbsp;&nbsp;系统信息</a>
        </div>
        <!--左边菜单栏-->
        <div class="col-sm-10">
            <ol class="breadcrumb">
                <li class="active">菜单
                </li>
                <li class="active">账单一览
                </li>
            </ol>
            <div class="panel panel-default">
                <div class="panel-heading">
                    搜索
                </div>
                <div class="panel-body">
                    <form role="form" class="form-inline" th:action="@{/bill/search}">
                        <div class="form-group">
                            <label for="year">年份</label>
                            <select class="form-control" name="year" id="year">
                                <option value="2020" selected>2020年</option>
                                <option value="2021">2021年</option>
                                <option value="2022">2022年</option>
                                <option value="2023">2023年</option>
                            </select>
                        </div>
                        <div class="form-group" style="padding-left: 15px;">
                            <label for="month">月份</label>
                            <select class="form-control" name="month" id="month">
                                <option value="1" selected>1月</option>
                                <option value="2">2月</option>
                                <option value="3">3月</option>
                                <option value="4">4月</option>
                                <option value="5">5月</option>
                                <option value="6">6月</option>
                                <option value="7">7月</option>
                                <option value="8">8月</option>
                                <option value="19">9月</option>
                                <option value="10">10月</option>
                                <option value="11">11月</option>
                                <option value="12">12月</option>
                            </select>
                        </div>
                        <div class="form-group" style="padding-left: 15px;">
                            <label for="usageType">用途分类</label>
                            <select class="form-control" name="usageType" id="usageType">
                                <option>选择用途分类</option>
                                <option th:each="item: ${usageList}" th:text="${item.typeName}"
                                        th:value="${item.id}"></option>
                            </select>
                        </div>
                        <div class="form-group" style="padding-left: 15px;">
                            <label for="payWay">支付方式分类</label>
                            <select class="form-control" name="payWay" id="payWay">
                                <option>选择支付方式分类</option>
                                <option th:each="item: ${payWayList}" th:text="${item.wayName}"
                                        th:value="${item.id}"></option>
                            </select>
                        </div>
                        <div class="form-group">
                            <button type="submit" class="btn btn-default">开始搜索</button>
                        </div>
                    </form>
                </div>
            </div>
            <!--列表展示-->
            <div class="table-responsive">
                <table class="table table-striped ">
                    <thead>
                    <tr>
                        <th style="display:none">账单id</th>
                        <th>账单日期</th>
                        <th>账单金额</th>
                        <th>收支分类</th>
                        <th>用途分类</th>
                        <th>支付方式</th>
                        <th>账单详情</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:if="${not #lists.isEmpty(result.getData().getDataList())}"
                        th:each="bill, stat: ${result.getData().getDataList()}">
                        <td style="display: none" th:text="${bill.billId}">Test001</td>
                        <td th:text="${bill.formattedBillDate}">2019-12-31</td>
                        <td th:text="${bill.amount}">交通</td>
                        <td th:text="${bill.inOutName}">支付宝</td>
                        <td th:text="${bill.usageTypeName}">0.00</td>
                        <td th:text="${bill.payWayName}">不怕，有的是钱！</td>
                        <td th:text="${bill.detail}">账单详情</td>
                        <td>
                            <div class="btn-group">
                                <button class="btn btn-default" data-toggle="modal"
                                        data-target="#add_bill">新增
                                </button>
                                <button id="edit" class="btn btn-info" data-toggle="modal" data-target="#edit_bill" th:attr="data-bill-id=${bill.billId}">修改</button>
                                <a th:href="@{'/bill/delete?billId=' + ${bill.billId}}" class="btn btn-danger">删除</a>
                            </div>
                        </td>
                    </tr>
                    <tr th:if="${#lists.isEmpty(result.getData().getDataList())}">
                        <td colspan="6"><strong>数据不存在！</strong></td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <ul class="pagination" style="float: right; padding-right:30px">
                <li>
                    <a href="#" th:href="@{/bill/list?page=1}">&laquo;</a>
                </li>
                <li th:if="${currentPage} &gt; 1">
                    <a th:text="${currentPage - 1}"
                       th:href="@{'/bill/list?page=' + ${currentPage - 1}}">1</a>
                </li>
                <li class="active">
                    <a th:text="${currentPage}"
                       th:href="@{'/bill/list?page=' + ${currentPage}}">1</a>
                </li>
                <li th:if="${currentPage} &lt; ${result.getData().getTotalPages()}">
                    <a th:text="${currentPage + 1}"
                       th:href="@{'/bill/list?page=' + ${currentPage + 1}}">1</a>
                </li>
                <li>
                    <a th:if="${not #lists.isEmpty(result.getData().getDataList())}" href="#"
                       th:href="@{'/bill/list?page=' + ${result.getData().getTotalPages()}}">&raquo;</a>
                </li>
            </ul>
        </div>
    </div>
</div>


<!-- 创建数据 -->

<div class="modal fade" id="add_bill" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <p>新增账单数据</p>
            </div>
            <div class="modal-body">
                <form th:action="@{/bill/create}" th:method="post">
                    <div class="form-group">
                        <label>收支分类</label>
                        <div class="form-control">
                            <label class="radio-inline">
                                <input type="radio" name="inOut" id="inOut1" th:value="${GLOBAL_INOUT_EXPENSE_CODE}">
                                <p th:text="${GLOBAL_INOUT_EXPENSE_NAME}"></p>
                            </label>
                            <label class="radio-inline">
                                <input type="radio" name="inOut" id="inOut2" th:value="${GLOBAL_INOUT_INCOME_CODE}">
                                <p th:text="${GLOBAL_INOUT_INCOME_NAME}"></p>
                            </label>
                            <label class="radio-inline">
                                <input type="radio" name="inOut" id="inOut3" th:value="${GLOBAL_INOUT_LEND_CODE}">
                                <p th:text="${GLOBAL_INOUT_LEND_NAME}"></p>
                            </label>
                            <label class="radio-inline">
                                <input type="radio" name="inOut" id="inOut4" th:value="${GLOBAL_INOUT_BORROW_CODE}">
                                <p th:text="${GLOBAL_INOUT_BORROW_NAME}"></p>
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="bill_date">消费日期</label>
                        <input type="date" name="billDate" class="form-control" id="bill_date" placeholder="消费日期">
                    </div>
                    <div class="form-group">
                        <label for="usage_type">消费类型</label>
                        <select name="usageType" id="usage_type" class="form-control">
                            <option>选择消费类型</option>
                            <option th:each="item: ${usageList}" th:text="${item.typeName}"
                                    th:value="${item.id}"></option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="pay_way">支付方式</label>
                        <select name="payWay" id="pay_way" class="form-control">
                            <option>选择支付方式分类</option>
                            <option th:each="item: ${payWayList}" th:text="${item.wayName}"
                                    th:value="${item.id}"></option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="amount">消费金额</label>
                        <input class="form-control" type="number" step="0.01" name="amount" id="amount" placeholder="消费金额"/>
                    </div>
                    <div class="form-group">
                        <label for="detail">账单详情</label>
                        <textarea class="form-control" rows="3" name="detail" id="detail" placeholder="账单详情"></textarea>
                    </div>
                    <button type="submit" class="btn btn-default">提交表单</button>
                </form>
            </div>
            <div class="modal-footer">
                <button type="submit" class="btn btn-default" data-dismiss="modal">关闭
                </button>
            </div>
        </div>
    </div>
</div>


<!-- 修改数据 -->

<div class="modal fade" id="edit_bill" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <p>新增账单数据</p>
            </div>
            <div class="modal-body">
                <form th:action="@{/bill/edit}" method="post">
                    <div class="form-group">

                        <div class="form-group">
                            <label for="billId1">账单id</label>
                            <input type="text" name="billId" class="form-control" id="billId1" placeholder="">
                        </div>

                        <label>收支分类</label>
                        <div class="form-control">
                            <label class="radio-inline">
                                <input type="radio" name="inOut" id="inOut11" th:value="${GLOBAL_INOUT_EXPENSE_CODE}">
                                <p th:text="${GLOBAL_INOUT_EXPENSE_NAME}"></p>
                            </label>
                            <label class="radio-inline">
                                <input type="radio" name="inOut" id="inOut21" th:value="${GLOBAL_INOUT_INCOME_CODE}">
                                <p th:text="${GLOBAL_INOUT_INCOME_NAME}"></p>
                            </label>
                            <label class="radio-inline">
                                <input type="radio" name="inOut" id="inOut31" th:value="${GLOBAL_INOUT_LEND_NAME}">
                                <p th:text="${GLOBAL_INOUT_LEND_NAME}"></p>
                            </label>
                            <label class="radio-inline">
                                <input type="radio" name="inOut" id="inOut41" th:value="${GLOBAL_INOUT_BORROW_NAME}">
                                <p th:text="${GLOBAL_INOUT_BORROW_NAME}"></p>
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="bill_date1">消费日期</label>
                        <input type="date" name="billDate" class="form-control" id="bill_date1" placeholder="消费日期">
                    </div>
                    <div class="form-group">
                        <label for="usage_type1">消费类型</label>
                        <select name="usageType" id="usage_type1" class="form-control">
                            <option>选择消费类型</option>
                            <option th:each="item: ${usageList}" th:text="${item.typeName}"
                                    th:value="${item.id}"></option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="pay_way1">支付方式</label>
                        <select name="payWay" id="pay_way1" class="form-control">
                            <option>选择支付方式分类</option>
                            <option th:each="item: ${payWayList}" th:text="${item.wayName}"
                                    th:value="${item.id}"></option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="amount1">消费金额</label>
                        <input class="form-control" type="number" step="0.01" name="amount" id="amount1" placeholder="消费金额"/>
                    </div>
                    <div class="form-group">
                        <label for="detail1">账单详情</label>
                        <textarea class="form-control" rows="3" name="detail" id="detail1"
                                  placeholder="账单详情"></textarea>
                    </div>
                    <button type="submit" class="btn btn-default">提交表单</button>
                </form>
            </div>
            <div class="modal-footer">
                <button type="submit" class="btn btn-default" data-dismiss="modal">关闭
                </button>
            </div>
        </div>
    </div>
</div>


<!-- 底部页脚部分 -->
<div class="footer">
    <p class="text-center">
        &copy; 2019-2020 iced-cola.
    </p>
</div>

<script type="text/javascript" th:src="@{../lib/jquery-3.4.1/jquery-3.4.1.min.js}"></script>
<script type="text/javascript" th:src="@{../lib/bootstrap-3.3.7/dist/js/bootstrap.min.js}"></script>
<script type="text/javascript">
    $(document).on("click", "#edit", function() {
        var billId = $(this).data("bill-id");
        $("#billId1").val(billId);
    });

<!--    $(document).ready(function() {-->
<!--    console.log("test");-->
<!--        $('#edit_bill').on('show.bs.modal', function (event) {-->
<!--            var billId = $(event.relatedTarget.data('bill-id');-->
<!--            console.log("=====" + billId);-->
<!--            $(event.currentTarget).find('input[name="billId"]').val(billId);-->
<!--        });-->
<!--    });-->
</script>
</body>
</html>